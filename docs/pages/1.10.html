<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<title>STGL</title>
<link rel="stylesheet" type="text/css" href="..//css/stdoc.css"/>
<script type="text/javascript" src="..//js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="..//js/stdoc.js"></script>
</head>
<body>
<div id="div_model" style="display:none">BOOK</div>
<div id="div_body">
<div id="div_logo"></div>
<div id="div_left">
<div id="div_left_list">
<ul class='ul_group_root'>
<li>
    <a class='a_node_root anchor_btn' name='a_a' href='#a_a'>摄像机</a>
    <ul>
        <li class='li_node_sub'><a class='anchor_btn' name='a_b' href='#a_b'>并没有摄像机</a></li>
        <li class='li_node_sub'><a class='anchor_btn' name='a_c' href='#a_c'>构建摄像机</a></li>
        <li class='li_node_sub'><a class='anchor_btn' name='a_d' href='#a_d'>建立相机坐标系</a></li>
        <li class='li_node_sub'><a class='anchor_btn' name='a_e' href='#a_e'>旋转</a></li>
        <li class='li_node_sub'><a class='anchor_btn' name='a_f' href='#a_f'>平移</a></li>
        <li class='li_node_sub'><a class='anchor_btn' name='a_g' href='#a_g'>添加限制</a></li>
        <li class='li_node_sub'><a class='anchor_btn' name='a_h' href='#a_h'>使用相机</a></li>
    </ul>
</li>
</ul><div class='div_left_space_space'></div>
</div>
<span id="span_time">2022-08-22 -> by:<span>DebugST</span></span>
</div>
<div id="div_right">
<span class='span_location'>1.入门 &gt; 10.摄像机<span style='float:right'>2022-08-19</span></span><h1 class='h_title anchor_point' name='a_a'>摄像机</h1>
<div class='div_hightlight' style='background-color:goldenrod;color:black'>
<p>这一节和原教程差异很大，读者可以查看原教程：<a class='mark' target='_blank' href='https://learnopengl-cn.github.io/01%20Getting%20started/09%20Camera/'>learnopengl-cn</a> <a class='mark' target='_blank' href='https://learnopengl.com/Getting-started/Camera'>learnopengl</a></p>
<p>这一节主要是从作者的思维角度去构造一个<span class='mark'>摄像机</span>类，在作者构造的<span class='mark'>摄像机</span>类中并不会使用<span class='mark'>GLM.LookAt</span>函数。</p>
</div>
<p>在上一节中我们已经可以看到一个真正<span class='mark'>3D</span>的世界了，我们通过使用<span class='mark'>View Matrix</span>来构造了一个假想的<span class='mark'>摄像机</span>，而上一节的<span class='mark'>Matrix</span>我们仅仅是<span class='mark'>往后</span>面移动了3个单位，并没有做一些复杂的操作。比如我们希望在世界坐标中指定相机的位置，并且让相机的镜头直接面对目标物体。如果我们自己构造<span class='mark'>View Matrix</span>的话需要<span class='mark'>Translate</span><span class='mark'>Rotate</span>等操作才能完成。事实上我们使用<span class='mark'>GLM.LookAt</span>就可以直接给我们构造一个<span class='mark'>View Matrix</span>。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(0,255,255,1)'>Matrix4F</span> <span style='color:rgba(255,0,255,1)'>LookAt</span><span style='color:rgba(255,255,255,1)'>(</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,255,1)'>Vector3F</span> eye<span style='color:rgba(255,255,255,1)'>,</span>       <span style='color:rgba(0,255,0,1)'>// 相机位置</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,255,1)'>Vector3F</span> center<span style='color:rgba(255,255,255,1)'>,</span>    <span style='color:rgba(0,255,0,1)'>// 目标位置</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,255,1)'>Vector3F</span> up         <span style='color:rgba(0,255,0,1)'>// 相机顶部朝向 (eye + center)只能确定镜头的朝向，</span>
<span class='span_code_line'></span>    <span style='color:rgba(255,255,255,1)'>)</span>                   <span style='color:rgba(0,255,0,1)'>// 但是相机还可以左右滚动，所以需要一个up向量固定相机</span></pre>
</div>
<img src='../images/1.A.camera_axes.png'/>
<p>但是这一节中作者并不打算过多介绍<span class='mark'>GLM.LookAt</span>，原版教程中使用<span class='mark'>GLM.LookAt</span>构建了一个<span class='mark'>摄像机</span>类。但是作者觉得原版教程中构造的<span class='mark'>摄像机</span>类并不完美，所以作者自己构建了一个可以无死角<span class='mark'>移动</span>和<span class='mark'>旋转</span>的<span class='mark'>摄像机</span>。提供了两种模式，可用于第一人称射击游戏或者飞行类游戏。</p>
<div><h2 class='h_option anchor_point' name='a_b'>并没有摄像机</h2></div>
<div class='div_hightlight' style='background-color:goldenrod;color:black'>
<p>事实上在<span class='mark'>OpenGL</span>中并没有<span class='mark'>摄像机</span>这个东西，<span class='mark'>摄像机</span>只是我们自己假想出来的一个东西，还记得上一节中的代码吗？</p>
</div>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(100,149,237,1)'>var</span> matV <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(0,255,255,1)'>GLM</span><span style='color:rgba(219,112,147,1)'>.Translate</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(255,255,255,1)'>-</span><span style='color:rgba(144,238,144,1)'>3</span><span style='color:rgba(255,255,255,1)'>));</span>   <span style='color:rgba(0,255,0,1)'>// 其实摄像机的位置并不在(0,0,-3)位置 下一节中介绍</span></pre>
</div>
<p>而上面的效果为：<span class='mark'>摄像机</span>在<span class='mark'>(0,0,3)</span>的位置向<span class='mark'>-Z</span>方向观察的结果。是的你这里并没有看错摄像机的位置并不在<span class='mark'>(0,0,-3)</span>的位置，也不在<span class='mark'>(0,0,3)</span>，而真实的摄像机位置是<span class='mark'>(0,0,1)</span>。</p>
<p>😱😱😱😱😱😱 什么情况？？？？？？</p>
<p>上面已经提到过了，<span class='mark'>OpenGL</span>中并没有<span class='mark'>摄像机</span>这个东西，在<span class='mark'>你好 三角形</span>我们也从来没有用过<span class='mark'>摄像机</span>这个东西，可是我们依然看到了三角形。<span class='mark'>OpenGL</span>始终都是从<span class='mark'>世界坐标</span>的<span class='mark'>(0,0,1)</span>位置向<span class='mark'>(0,0,0)</span>方向去渲染画面。这一点是我们无法改变的。但是。。。我们可以改变的是物体的位置。</p>
<p>所以上一节我们提到的三个矩阵<span class='mark'>M-V-P</span>改变的都是模型位置。我们通过<span class='mark'>Model Matrix</span>改变物体坐标点在<span class='mark'>世界坐标</span>的位置，而<span class='mark'>View Matrix</span>并不是在设置<span class='mark'>摄像机</span>的位置，而是在<span class='mark'>Model Matrix</span>的基础上再进行一些改变，让它离<span class='mark'>世界坐标</span>远一点，这样看起来就像是有一个<span class='mark'>摄像机</span>在很远的位置进行拍摄，同样<span class='mark'>Projection Matrix</span>也只是在刚才的变换基础上进一步的加上<span class='mark'>投影</span>效果，<span class='mark'>M-V-P</span>并不是三个参数，因为<span class='mark'>M*V*P</span>只会得到一个矩阵。只是我们习惯将它们分开表示，让逻辑变得清晰。</p>
<div class='div_hightlight' style='background-color:skyblue;color:black'>
<p>所以为什么说<span class='mark'>(0,0,-3)</span>看上去就像是相机在<span class='mark'>(0,0,3)</span>的位置进行的拍摄，而真实的相机位置却又在<span class='mark'>(0,0,1)</span>，这个<span class='mark'>-3</span>的作用是让物体的<span class='mark'>Z-3</span>，而并不是在设置<span class='mark'>摄像机</span>的位置。</p>
</div>
<img src='../images/1.A.camera.gif'/>
<p>由于<span class='mark'>OpenGL</span>并没有<span class='mark'>摄像机</span>这个东西，如果我们一定要创建一个<span class='mark'>摄像机</span>的话，也只能把它放在<span class='mark'>(0,0,1)</span>这个位置，因为<span class='mark'>OpenGL</span>就是从这里开始渲染画面的。但是。。。因为位置都是都是相对的，我们并不一定要设置<span class='mark'>摄像机</span>的位置。如上图<span style='color:pink'>(图是网上偷来的)</span>，我们希望<span class='mark'>摄像机</span>在<span class='mark'>(2,0,3)</span>向左旋转<span class='mark'>33.7</span>度进行拍摄。其实我们也可以让相机在<span class='mark'>(0,0,0)</span>的位置，并且让物体移动<span class='mark'>(-2,0,-3)</span>并且旋转<span class='mark'>-33.7</span>度，效果也是一样的。而要让物体<span class='mark'>旋转</span><span class='mark'>平移</span>等操作，我们使用<span class='mark'>Matrix</span>就能完成，而我们把这个<span class='mark'>Matrix</span>叫做<span class='mark'>View Matrix</span>，这也就是为什么我们会说<span class='mark'>View Matrix</span>相当于<span class='mark'>摄像机</span>。因为<span class='mark'>View Matrix</span>所保存的就是让物体变换到<span class='mark'>摄像机</span>的相对位置去。</p>
<div><h2 class='h_option anchor_point' name='a_c'>构建摄像机</h2></div>
<p><span style='color:pink'>如果我们需要去构建一个<span class='mark'>摄像机</span>类，那么这个类的核心功能一定是如何创建一个<span class='mark'>View Matrix</span>。</span></p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>class</span> <span style='color:rgba(0,255,255,1)'>GLCamera</span><span style='color:rgba(255,255,255,1)'>{</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(0,255,255,1)'>Matrix4F</span> ViewMatrix<span style='color:rgba(255,255,255,1)'>{</span><span style='color:rgba(30,144,255,1)'>get</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(30,144,255,1)'>private set</span><span style='color:rgba(255,255,255,1)'>;}
<span class='span_code_line'></span>}</span></pre>
</div>
<p>为什么需要构建一个<span class='mark'>摄像机</span>类？它的核心功能不就是创建一个<span class='mark'>View Matrix</span>吗？我们自己也可以构建，为什么一定要放在一个类里面去构建？是的，其实<span class='mark'>摄像机</span>类并不是必须的。之所以用一个类去构建<span class='mark'>View Matrix</span>，仅仅是想隐藏一些复杂的过程，提供一些操作接口。而使用者无需关心<span class='mark'>View Matrix</span>是如何被构建出来的。比如提供一个<span class='mark'>GLCamera.MoveLeft(float)</span>的功能，让相机向左边移动一定距离，或者一些更加复杂的操作。</p>
<p>在<span class='mark'>GLCamera</span>类中我们需要使用两个矩阵<span class='mark'>Translate Matrix</span><span class='mark'>Rotate Matrix</span>。通过<span class='mark'>Rotate * Translate</span>得到<span class='mark'>View Matrix</span>。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>class</span> <span style='color:rgba(0,255,255,1)'>GLCamera</span><span style='color:rgba(255,255,255,1)'>{</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(0,255,255,1)'>Matrix4F</span> ViewMatrix<span style='color:rgba(255,255,255,1)'>{</span><span style='color:rgba(30,144,255,1)'>get</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(30,144,255,1)'>private set</span><span style='color:rgba(255,255,255,1)'>;}</span>
<span class='span_code_line'></span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span> Position<span style='color:rgba(255,255,255,1)'>{</span><span style='color:rgba(30,144,255,1)'>get</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(30,144,255,1)'>private set</span><span style='color:rgba(255,255,255,1)'>;}</span>         <span style='color:rgba(0,255,0,1)'>// 保存相机当前的位置</span>
<span class='span_code_line'></span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>private</span> <span style='color:rgba(0,255,255,1)'>Matrix4F</span> m_mat4_rotate <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(0,255,255,1)'>Matrix4F</span><span style='color:rgba(112,128,144,1)'>.Identity</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(0,255,0,1)'>// 保存旋转的操作</span>
<span class='span_code_line'></span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>private</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>UpdateMatrix</span><span style='color:rgba(255,255,255,1)'>() {</span>   <span style='color:rgba(0,255,0,1)'>// GLCamera提供了很多操作，一些操作需要重新刷新 ViewMatrix</span>
<span class='span_code_line'></span>        <span style='color:rgba(100,149,237,1)'>var</span> mat <span style='color:rgba(255,255,255,1)'>=</span> m_mat4_rotate<span style='color:rgba(255,255,255,1)'>;</span>        <span style='color:rgba(0,255,0,1)'>// 当前所有的旋转操作</span>
<span class='span_code_line'></span>        mat<span style='color:rgba(219,112,147,1)'>.Translate</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(255,255,255,1)'>-</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Positon</span><span style='color:rgba(255,255,255,1)'>);</span>   <span style='color:rgba(0,255,0,1)'>// 取反是希望物体向反方向移动，Position只是我们假想出来的相机位置。</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.ViewMatrix</span> <span style='color:rgba(255,255,255,1)'>=</span> mat<span style='color:rgba(255,255,255,1)'>;</span>          <span style='color:rgba(0,255,0,1)'>// = m_mat4_rotate * GLM.Translate(-this.Position)</span>
<span class='span_code_line'></span>    <span style='color:rgba(255,255,255,1)'>}
<span class='span_code_line'></span>}</span></pre>
</div>
<p>其实平移是很好处理的，直接使用<span class='mark'>GLCamera.Position</span>构建一个平移矩阵就可以了。但是<span class='mark'>旋转</span>就有点复杂了。</p>
<div><h2 class='h_option anchor_point' name='a_d'>建立相机坐标系</h2></div>
<p>为了完成一些复杂的操作我们可能需要构建<span class='mark'>摄像机</span>自己的坐标系统，而不是使用<span class='mark'>世界坐标</span>。比如我们希望画面向前移动（游戏人物向前移动），我们可能希望的是朝着<span class='mark'>摄像机</span>的前方移动，而不是以<span class='mark'>世界坐标</span>作为参考进行操作。<span class='mark'>旋转</span>操作也是同样的，我们可能更希望以<span class='mark'>摄像机</span>当前的姿态进行<span class='mark'>旋转</span>。所以我们需要添加三个属性。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span> Forward <span style='color:rgba(255,255,255,1)'>{</span> <span style='color:rgba(30,144,255,1)'>get</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(30,144,255,1)'>private set</span><span style='color:rgba(255,255,255,1)'>; }</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span> UP <span style='color:rgba(255,255,255,1)'>{</span> <span style='color:rgba(30,144,255,1)'>get</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(30,144,255,1)'>private set</span><span style='color:rgba(255,255,255,1)'>; }</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span> Right <span style='color:rgba(255,255,255,1)'>{</span> <span style='color:rgba(30,144,255,1)'>get</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(30,144,255,1)'>private set</span><span style='color:rgba(255,255,255,1)'>; }</span></pre>
</div>
<p>而我们在初始化相机的时候就把这三个值确定</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(0,255,0,1)'>//Forward,Right,UP 构成相机自身坐标系统</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Forward</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(255,255,255,1)'>-</span><span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>);</span>  <span style='color:rgba(0,255,0,1)'>//相机朝前向量</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>);</span>     <span style='color:rgba(0,255,0,1)'>//相机右侧向量</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.UP</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>);</span>        <span style='color:rgba(0,255,0,1)'>//相机顶部向量</span></pre>
</div>
<p><span class='mark'>OpenGL</span>是右手坐标系，所以面向我们的是<span class='mark'>+Z</span>，里面则是<span class='mark'>-Z</span>。</p>
<img src='../images/1.A.handle.png'/>
<p>定义三个向量分别确定<span class='mark'>摄像机</span>的三个朝向，可以理解为<span class='mark'>摄像机</span>自己的<span class='mark'>X(Right)</span><span class='mark'>Y(UP)</span><span class='mark'>Z(Forward)</span>坐标系统。我们在使用的时候直接当做<span class='mark'>单位向量</span>，用来表示方向。所以我们的每一次<span class='mark'>旋转</span>操作都需要重新确定方向。</p>
<img src='../images/1.A.camera_pitch_yaw_roll.png'/>
<p>旋转有三个方向，可以看到<span class='mark'>Pitch</span>是以<span class='mark'>X</span>作为参考旋转的，但是我们有自己的<span class='mark'>Right</span>向量作为参考，而<span class='mark'>Yaw</span>的时候我们使用<span class='mark'>UP</span>作为参考，<span class='mark'>Roll</span>使用<span class='mark'>Forward</span>作为参考。这样我们可以进行以<span class='mark'>摄像机</span>自身作为参考的任意<span class='mark'>旋转</span>了。</p>
<div><h2 class='h_option anchor_point' name='a_e'>旋转</h2></div>
<p>我们有三个向量作为参考，但是在每次<span class='mark'>旋转</span>之后一定要更新参考系。以<span class='mark'>Yaw</span>为例。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>Yaw</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(100,149,237,1)'>float</span> angle<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>angle <span style='color:rgba(255,255,255,1)'>==</span> <span style='color:rgba(144,238,144,1)'>0</span> <span style='color:rgba(255,255,255,1)'>||</span> <span style='color:rgba(100,149,237,1)'>float</span><span style='color:rgba(219,112,147,1)'>.IsNaN</span><span style='color:rgba(255,255,255,1)'>(</span>angle<span style='color:rgba(255,255,255,1)'>))</span> <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    <span style='color:rgba(100,149,237,1)'>var</span> mat <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(0,255,255,1)'>GLM</span><span style='color:rgba(112,128,144,1)'>.GLM</span><span style='color:rgba(219,112,147,1)'>.Rotate</span><span style='color:rgba(255,255,255,1)'>(</span>angle<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(255,255,255,1)'>-</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.UP</span><span style='color:rgba(255,255,255,1)'>);</span>              <span style='color:rgba(0,255,0,1)'>// 旋转参考系</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,255,1)'>Vector4F</span> vec_r <span style='color:rgba(255,255,255,1)'>=</span> mat <span style='color:rgba(255,255,255,1)'>*</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector4F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>);</span>     <span style='color:rgba(0,255,0,1)'>// 计算新的 Right</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span>vec_r<span style='color:rgba(112,128,144,1)'>.X</span><span style='color:rgba(255,255,255,1)'>,</span> vec_r<span style='color:rgba(112,128,144,1)'>.Y</span><span style='color:rgba(255,255,255,1)'>,</span> vec_r<span style='color:rgba(112,128,144,1)'>.Z</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,255,1)'>Vector4F</span> vec_f <span style='color:rgba(255,255,255,1)'>=</span> mat <span style='color:rgba(255,255,255,1)'>*</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector4F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Forward</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>);</span>   <span style='color:rgba(0,255,0,1)'>// 计算新的 Forward</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Forward</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span>vec_f<span style='color:rgba(112,128,144,1)'>.X</span><span style='color:rgba(255,255,255,1)'>,</span> vec_f<span style='color:rgba(112,128,144,1)'>.Y</span><span style='color:rgba(255,255,255,1)'>,</span> vec_f<span style='color:rgba(112,128,144,1)'>.Z</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>    m_mat4_rotate <span style='color:rgba(255,255,255,1)'>*=</span> <span style='color:rgba(0,255,255,1)'>GLM</span><span style='color:rgba(112,128,144,1)'>.GLM</span><span style='color:rgba(219,112,147,1)'>.Rotate</span><span style='color:rgba(255,255,255,1)'>(</span>angle<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.UP</span><span style='color:rgba(255,255,255,1)'>);</span>        <span style='color:rgba(0,255,0,1)'>// 旋转物体</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(219,112,147,1)'>.UpdateMatrix</span><span style='color:rgba(255,255,255,1)'>();
<span class='span_code_line'></span>}</span></pre>
</div>
<div class='div_hightlight' style='background-color:goldenrod;color:black'>
<p>可以看到旋转使用<span class='mark'>UP</span>做参考的时候，但是为什么旋转坐标系和旋转物体使用的不一样？还记得上面说过的吗？<span class='mark'>OpenGL</span>是没有<span class='mark'>摄像机</span>的，虽然我们构建一个假想的<span class='mark'>摄像机</span>，但是我们里面所有的数据都是<span class='mark'>相对</span>的，我们希望相机<span class='mark'>向左</span>旋转，实际上我们操作的是让物体<span class='mark'>向右</span>旋转。我们在上面平移的时候也是使用的<span class='mark'>-this.Positon</span>。</p>
</div>
<p>举一反三我们还可以编写<span class='mark'>YawLeft(angle)</span><span class='mark'>YawRight(angle)</span>让他们去调用<span class='mark'>Yaw(angle)</span>只是在调用的时候一个使用<span class='mark'>angle</span>另一个使用<span class='mark'>-angle</span>，而在<span class='mark'>YawXXX(angle)</span>中都使用<span class='mark'>正数</span>。</p>
<p>使用同样的方式我们可以完成<span class='mark'>Pitch</span><span class='mark'>Roll</span>的操作。</p>
<div><h2 class='h_option anchor_point' name='a_f'>平移</h2></div>
<p>平移的时候我们无需重新更新<span class='mark'>Forward</span><span class='mark'>UP</span><span class='mark'>Right</span>向量，让它保存原有视角就可以了，仅仅改变位置。我们可以编写一个函数实现<span class='mark'>瞬间移动</span>。让相机直接移动到某一个位置。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>Move</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>Vector3F</span> position<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Positon</span> <span style='color:rgba(255,255,255,1)'>=</span> position<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(219,112,147,1)'>.UpdateMatrix</span><span style='color:rgba(255,255,255,1)'>();
<span class='span_code_line'></span>}</span></pre>
</div>
<p>甚至我们可以连旋转角度也给重新初始化，比如游戏人物死亡后重新复活的时候可能就需要这样的操作。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>Reset</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>Vector3F</span> position<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>float</span> yawAngle<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Positon</span> <span style='color:rgba(255,255,255,1)'>=</span> position<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,0,1)'>//重置坐标参考系</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Forward</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(255,255,255,1)'>-</span><span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>);</span>  <span style='color:rgba(0,255,0,1)'>//相机朝前向量</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>);</span>     <span style='color:rgba(0,255,0,1)'>//相机右侧向量</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.UP</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>);</span>        <span style='color:rgba(0,255,0,1)'>//相机顶部向量</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(219,112,147,1)'>.Yaw</span><span style='color:rgba(255,255,255,1)'>(</span>yawAngle<span style='color:rgba(255,255,255,1)'>);</span>     <span style='color:rgba(0,255,0,1)'>// 默认希望的水平朝向</span>
<span class='span_code_line'></span><span style='color:rgba(255,255,255,1)'>}</span></pre>
</div>
<p>但是我们可能并不想每一次<span class='mark'>Move</span>都自己计算一个新的位置传给<span class='mark'>GLCamera</span>。而是希望能提供一个<span class='mark'>方向</span>和<span class='mark'>距离</span>。让后相机朝着指定的<span class='mark'>方向</span>和<span class='mark'>距离</span>移动就可以了。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>Move</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>Vector3F</span> direction<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>float</span> distance<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,255,1)'>Vector3F</span> vec <span style='color:rgba(255,255,255,1)'>=</span> direction<span style='color:rgba(219,112,147,1)'>.GetNormalize</span><span style='color:rgba(255,255,255,1)'>()</span> <span style='color:rgba(255,255,255,1)'>*</span> distance<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Positon</span> <span style='color:rgba(255,255,255,1)'>+=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span>vec<span style='color:rgba(112,128,144,1)'>.X</span><span style='color:rgba(255,255,255,1)'>,</span> vec<span style='color:rgba(112,128,144,1)'>.Y</span><span style='color:rgba(255,255,255,1)'>,</span> vec<span style='color:rgba(112,128,144,1)'>.Z</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(219,112,147,1)'>.UpdateMatrix</span><span style='color:rgba(255,255,255,1)'>();
<span class='span_code_line'></span>}</span></pre>
</div>
<p>我们用<span class='mark'>distance</span>*<span class='mark'>单位向量</span>，可以得到<span class='mark'>distance</span>在<span class='mark'>(X,Y,Z)</span>上的分量，然后<span class='mark'>this.Position</span>加上这些分量就可以了。</p>
<p>有了<span class='mark'>Move(direction,distance)</span>，同样我们还可以推导出<span class='mark'>MoveLeft(distance)</span><span class='mark'>MoveUp(distance)</span>等函数。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>MoveLeft</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(100,149,237,1)'>float</span> distance<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(219,112,147,1)'>.Move</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(255,255,255,1)'>-</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span><span style='color:rgba(255,255,255,1)'>,</span> distance<span style='color:rgba(255,255,255,1)'>);
<span class='span_code_line'></span>}</span>
<span class='span_code_line'></span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>MoveRight</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(100,149,237,1)'>float</span> distance<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(219,112,147,1)'>.Move</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span><span style='color:rgba(255,255,255,1)'>,</span> distance<span style='color:rgba(255,255,255,1)'>);
<span class='span_code_line'></span>}</span></pre>
</div>
<p>至此一个可以任意<span class='mark'>旋转</span>和<span class='mark'>平移</span>的<span class='mark'>摄像机</span>类我们就构建的差不多了。但是有些时候我们并不希望<span class='mark'>摄像机</span>的旋转是可以任意的。在一些第一人称射击游戏中，是没有<span class='mark'>Roll</span>操作的，虽然我们可以不去调用<span class='mark'>Roll</span>函数，但是<span class='mark'>Pitch</span>是有限制的。</p>
<p>比如枪向上的角度不能超过<span class='mark'>90</span>，不然人总是不可能往上一直转<span class='mark'>180</span>度，然后倒立在地上的吧？所以我们需要限制<span class='mark'>Pitch</span>的角度。</p>
<p>同样我们<span class='mark'>Yaw</span>的时候也不能参考相机的<span class='mark'>UP</span>了，如果不这样的话，假设现在已经<span class='mark'>Pitch</span>到<span class='mark'>90</span>度了，枪的准心对着天空，此时左右移动鼠标会发现人在以天空为中心旋转，也就是世界坐标的<span class='mark'>Y</span>作为参考，而如果依然使用相机的<span class='mark'>UP</span>作为<span class='mark'>Yaw</span>的参考，那么<span class='mark'>Yaw(180)</span>，枪的准心就对准地面了。</p>
<p>而作者同样希望在<span class='mark'>GLCamera</span>中提供这样的实现。</p>
<div><h2 class='h_option anchor_point' name='a_g'>添加限制</h2></div>
<p>一开始作者提到了两个模式，上面的实现是以相机自身作为参考做变换，也就是以<span class='mark'>飞机</span>的视角做的变换，而现在我们需要以<span class='mark'>第一人称</span>的视角去改变一下<span class='mark'>GLCamera</span>。而这两种模式，作者希望在<span class='mark'>构造器</span>中确定，一旦确定就无法更改。</p>
<p>所以作者提供了三个构造函数。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(255,0,255,1)'>GLCamera</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>Vector3F</span> position<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(255,255,255,1)'>:</span> <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(255,255,255,1)'>(</span>position<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>)) { }</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(255,0,255,1)'>GLCamera</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>Vector3F</span> position<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span> target<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(0,255,0,1)'>// 初始化的时候确定相机位置，并且对准想拍摄的地方
<span class='span_code_line'></span>// 以第一人称视角构建摄像机，并且确定Pitch的角度限制</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(255,0,255,1)'>GLCamera</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>Vector3F</span> position<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>float</span> downWardAngle<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>float</span> upWardAngle<span style='color:rgba(255,255,255,1)'>)</span></pre>
</div>
<p>所以我们需要一个私有变量来判断当前相机是什么模式。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>private</span> <span style='color:rgba(100,149,237,1)'>bool</span> m_b_lock_up<span style='color:rgba(255,255,255,1)'>;</span>           <span style='color:rgba(0,255,0,1)'>// 是否锁定UP true则以世界坐标Y作为参考，否则使用this.UP作为参考。</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>private</span> <span style='color:rgba(100,149,237,1)'>float</span> m_f_angle_pitch<span style='color:rgba(255,255,255,1)'>;</span>      <span style='color:rgba(0,255,0,1)'>// lock_up模式下，pitch当前的角度</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>private</span> <span style='color:rgba(100,149,237,1)'>float</span> m_f_angle_up<span style='color:rgba(255,255,255,1)'>;</span>         <span style='color:rgba(0,255,0,1)'>// lock_up模式下，pitch向上的最大角度</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>private</span> <span style='color:rgba(100,149,237,1)'>float</span> m_f_angle_down<span style='color:rgba(255,255,255,1)'>;</span>       <span style='color:rgba(0,255,0,1)'>// lock_up模式下，pitch向上的最大角度</span></pre>
</div>
<p>接需要对每个旋转函数进行一些修改，最主要的是<span class='mark'>Pitch</span>函数的更改</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>public</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>Pitch</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(100,149,237,1)'>float</span> angle<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>angle <span style='color:rgba(255,255,255,1)'>==</span> <span style='color:rgba(144,238,144,1)'>0</span> <span style='color:rgba(255,255,255,1)'>||</span> <span style='color:rgba(100,149,237,1)'>float</span><span style='color:rgba(219,112,147,1)'>.IsNaN</span><span style='color:rgba(255,255,255,1)'>(</span>angle<span style='color:rgba(255,255,255,1)'>))</span> <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>m_b_lock_up<span style='color:rgba(255,255,255,1)'>) {</span>  <span style='color:rgba(0,255,0,1)'>// 当是第一人称模式 我们需要对角度进行判断</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>angle <span style='color:rgba(255,255,255,1)'>&gt;</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>) {</span>    <span style='color:rgba(0,255,0,1)'>// down</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>m_f_angle_down <span style='color:rgba(255,255,255,1)'>==</span> m_f_angle_pitch<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>            m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>+=</span> angle<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>&gt;</span> m_f_angle_down<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>                angle <span style='color:rgba(255,255,255,1)'>-=</span> m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>-</span> m_f_angle_down<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>                m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>=</span> m_f_angle_down<span style='color:rgba(255,255,255,1)'>;
<span class='span_code_line'></span>            }
<span class='span_code_line'></span>        }</span> <span style='color:rgba(30,144,255,1)'>else</span> <span style='color:rgba(255,255,255,1)'>{</span>            <span style='color:rgba(0,255,0,1)'>// up</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>m_f_angle_up <span style='color:rgba(255,255,255,1)'>==</span> m_f_angle_pitch<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>            m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>+=</span> angle<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>&lt;</span> m_f_angle_up<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>                angle <span style='color:rgba(255,255,255,1)'>-=</span> m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>-</span> m_f_angle_up<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>                m_f_angle_pitch <span style='color:rgba(255,255,255,1)'>=</span> m_f_angle_up<span style='color:rgba(255,255,255,1)'>;
<span class='span_code_line'></span>            }
<span class='span_code_line'></span>        }
<span class='span_code_line'></span>    }</span>
<span class='span_code_line'></span>    <span style='color:rgba(0,255,255,1)'>Matrix4F</span> mat <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(0,255,255,1)'>GLM</span><span style='color:rgba(112,128,144,1)'>.GLM</span><span style='color:rgba(219,112,147,1)'>.Rotate</span><span style='color:rgba(255,255,255,1)'>(</span>angle<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(255,255,255,1)'>-</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Forward</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span>mat <span style='color:rgba(255,255,255,1)'>*</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector4F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Forward</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>));</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(255,255,255,1)'>!</span>m_b_lock_up<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.UP</span> <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span>mat <span style='color:rgba(255,255,255,1)'>*</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector4F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.UP</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>));
<span class='span_code_line'></span>    }</span>
<span class='span_code_line'></span>    m_mat4_rotate <span style='color:rgba(255,255,255,1)'>*=</span> <span style='color:rgba(0,255,255,1)'>GLM</span><span style='color:rgba(112,128,144,1)'>.GLM</span><span style='color:rgba(219,112,147,1)'>.Rotate</span><span style='color:rgba(255,255,255,1)'>(</span>angle<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(112,128,144,1)'>.Right</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>this</span><span style='color:rgba(219,112,147,1)'>.UpdateMatrix</span><span style='color:rgba(255,255,255,1)'>();
<span class='span_code_line'></span>}</span></pre>
</div>
<p>然后我们还需要在<span class='mark'>Roll</span>中添加一个判断</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>m_b_lock_up<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;</span></pre>
</div>
<p>而<span class='mark'>Yaw</span>我们则不用更改，在<span class='mark'>Yaw</span>中以<span class='mark'>this.UP</span>作为参考，但是<span class='mark'>m_b_lock_up</span>会让<span class='mark'>this.UP</span>一直保存<span class='mark'>(0,1,0)</span>，如果你也确实希望<span class='mark'>this.UP</span>始终朝向相机顶部，也是可以的，只是在<span class='mark'>Yaw</span>就不能使用<span class='mark'>this.UP</span>作为参考了，需要判断<span class='mark'>m_b_lock_up</span>，如果是<span class='mark'>true</span>直接使用<span class='mark'>new Vector3f(0,1,0)</span>否则使用<span class='mark'>this.UP</span>在<span class='mark'>Pitch</span>中继续更新<span class='mark'>this.UP</span>的值。当然这个看读者的意愿。</p>
<p>更多的代码请参考<span class='mark'>STLib.OpenGL.GL.Utils.GLCamera.cs</span>，<span class='mark'>GLCamera</span>已经内置在了<span class='mark'>STGL</span>项目中。</p>
<div><h2 class='h_option anchor_point' name='a_h'>使用相机</h2></div>
<p>我们使用上一节中的最后一个案例进行改进，让它更像一个游戏场景，首先我们需要添加几个成员变量。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(100,149,237,1)'>double</span> m_pos_y <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>;</span>  <span style='color:rgba(0,255,0,1)'>// 鼠标初始位置</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(100,149,237,1)'>double</span> m_pos_x <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(100,149,237,1)'>bool</span> m_b_inited<span style='color:rgba(255,255,255,1)'>;</span>     <span style='color:rgba(0,255,0,1)'>// 当前是否已经初始化鼠标位置</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(100,149,237,1)'>bool</span> m_b_captured<span style='color:rgba(255,255,255,1)'>;</span>   <span style='color:rgba(0,255,0,1)'>// 当前GLFW窗口是否已经捕获了鼠标
<span class='span_code_line'></span>// 构造一个飞机视角的相机 默认相机在(0,0,3)位置 并且默认朝向(0,0,0)位置，</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(0,255,255,1)'>GLCamera</span> m_camera <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>GLCamera</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(30,144,255,1)'>new</span> <span style='color:rgba(0,255,255,1)'>Vector3F</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(144,238,144,1)'>3</span><span style='color:rgba(255,255,255,1)'>));</span>
<span class='span_code_line'></span><span style='color:rgba(0,255,0,1)'>// 构造一个第一人称视角的相机
<span class='span_code_line'></span>// static GLCamera m_camera = new GLCamera(new Vector3F(0, 0, 3), 80, 80);</span></pre>
</div>
<p>当我们希望鼠标点进窗口的时候鼠标被<span class='mark'>GLFW</span>窗口捕获，在我们的窗口初始化好之后，我们需要绑定一个事件。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(219,112,147,1)'>.SetMouseButtonCallback</span><span style='color:rgba(255,255,255,1)'>(</span>window<span style='color:rgba(255,255,255,1)'>,</span> onMouseButton<span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span><span style='color:rgba(0,255,0,1)'>//============================</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>onMouseButton</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>IntPtr</span> window<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>int</span> button<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>int</span> action<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>int</span> mods<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span>action <span style='color:rgba(255,255,255,1)'>==</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.PRESS</span><span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>switch</span> <span style='color:rgba(255,255,255,1)'>(</span>button<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.MOUSE_BUTTON_LEFT</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>                <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(219,112,147,1)'>.SetInputMode</span><span style='color:rgba(255,255,255,1)'>(</span>window<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.CURSOR</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.CURSOR_DISABLED</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>                m_b_captured <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>true</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>                <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;
<span class='span_code_line'></span>        }
<span class='span_code_line'></span>    }
<span class='span_code_line'></span>}</span></pre>
</div>
<p>我们希望移动鼠标的时候，场景的视角跟随移动。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(219,112,147,1)'>.SetCursorPosCallback</span><span style='color:rgba(255,255,255,1)'>(</span>window<span style='color:rgba(255,255,255,1)'>,</span> OnMouseMove<span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span><span style='color:rgba(0,255,0,1)'>//============================</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>OnMouseMove</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>IntPtr</span> window<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>double</span> xpos<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>double</span> ypos<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(255,255,255,1)'>!</span>m_b_captured<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;</span>  <span style='color:rgba(0,255,0,1)'>// 如果鼠标没有点进窗口 不做处理</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>if</span> <span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(255,255,255,1)'>!</span>m_b_inited<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>        m_pos_x <span style='color:rgba(255,255,255,1)'>=</span> xpos<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        m_pos_y <span style='color:rgba(255,255,255,1)'>=</span> ypos<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        m_b_inited <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>true</span><span style='color:rgba(255,255,255,1)'>;
<span class='span_code_line'></span>    }</span>
<span class='span_code_line'></span>    <span style='color:rgba(100,149,237,1)'>float</span> f <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(144,238,144,1)'>0</span><span style='color:rgba(112,128,144,1)'>.</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>;</span> <span style='color:rgba(0,255,0,1)'>// 移动速度</span>
<span class='span_code_line'></span>    <span style='color:rgba(100,149,237,1)'>var</span> pitch <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(100,149,237,1)'>float</span><span style='color:rgba(255,255,255,1)'>)(</span>ypos <span style='color:rgba(255,255,255,1)'>-</span> m_pos_y<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(255,255,255,1)'>*</span> f<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    <span style='color:rgba(100,149,237,1)'>var</span> yaw <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(100,149,237,1)'>float</span><span style='color:rgba(255,255,255,1)'>)(</span>xpos <span style='color:rgba(255,255,255,1)'>-</span> m_pos_x<span style='color:rgba(255,255,255,1)'>)</span> <span style='color:rgba(255,255,255,1)'>*</span> f<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    m_camera<span style='color:rgba(219,112,147,1)'>.Yaw</span><span style='color:rgba(255,255,255,1)'>(</span>yaw<span style='color:rgba(255,255,255,1)'>);</span>          <span style='color:rgba(0,255,0,1)'>// 让相机进行一些旋转操作</span>
<span class='span_code_line'></span>    m_camera<span style='color:rgba(219,112,147,1)'>.Pitch</span><span style='color:rgba(255,255,255,1)'>(</span>pitch<span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>    m_pos_x <span style='color:rgba(255,255,255,1)'>=</span> xpos<span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>    m_pos_y <span style='color:rgba(255,255,255,1)'>=</span> ypos<span style='color:rgba(255,255,255,1)'>;
<span class='span_code_line'></span>}</span></pre>
</div>
<p>我们也希望配合一些键盘操作比如<span class='mark'>W</span><span class='mark'>A</span><span class='mark'>S</span><span class='mark'>D</span>。</p>
<div class='div_code'>
<pre class='pre_code'><span class='span_code_line'></span><span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(219,112,147,1)'>.SetKeyCallback</span><span style='color:rgba(255,255,255,1)'>(</span>window<span style='color:rgba(255,255,255,1)'>,</span> OnKeyDown<span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span><span style='color:rgba(0,255,0,1)'>//============================</span>
<span class='span_code_line'></span><span style='color:rgba(30,144,255,1)'>static</span> <span style='color:rgba(100,149,237,1)'>void</span> <span style='color:rgba(255,0,255,1)'>OnKeyDown</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(0,255,255,1)'>IntPtr</span> window<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>int</span> key<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>int</span> scancode<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>int</span> action<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(100,149,237,1)'>int</span> mods<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>    <span style='color:rgba(30,144,255,1)'>switch</span> <span style='color:rgba(255,255,255,1)'>(</span>key<span style='color:rgba(255,255,255,1)'>) {</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_ESCAPE</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(219,112,147,1)'>.SetInputMode</span><span style='color:rgba(255,255,255,1)'>(</span>window<span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.CURSOR</span><span style='color:rgba(255,255,255,1)'>,</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.CURSOR_NORMAL</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            m_b_captured <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>false</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>            m_b_inited <span style='color:rgba(255,255,255,1)'>=</span> <span style='color:rgba(30,144,255,1)'>false</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>return</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_UP</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.PitchUp</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_DOWN</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.PitchDown</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_LEFT</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.YawLeft</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_RIGHT</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.YawRight</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_A</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.MoveLeft</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(112,128,144,1)'>.</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_D</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.MoveRight</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(112,128,144,1)'>.</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_W</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.MoveForward</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(112,128,144,1)'>.</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_S</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.MoveBack</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(112,128,144,1)'>.</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_I</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.MoveUp</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(112,128,144,1)'>.</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_K</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.MoveDown</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(112,128,144,1)'>.</span><span style='color:rgba(144,238,144,1)'>1f</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_J</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.RollLeft</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;</span>
<span class='span_code_line'></span>        <span style='color:rgba(30,144,255,1)'>case</span> <span style='color:rgba(0,255,255,1)'>GLFW</span><span style='color:rgba(112,128,144,1)'>.KEY_L</span><span style='color:rgba(255,255,255,1)'>:</span>
<span class='span_code_line'></span>            m_camera<span style='color:rgba(219,112,147,1)'>.RollRight</span><span style='color:rgba(255,255,255,1)'>(</span><span style='color:rgba(144,238,144,1)'>1</span><span style='color:rgba(255,255,255,1)'>);</span>
<span class='span_code_line'></span>            <span style='color:rgba(30,144,255,1)'>break</span><span style='color:rgba(255,255,255,1)'>;
<span class='span_code_line'></span>    }
<span class='span_code_line'></span>}</span></pre>
</div>
<p>然后运行程序看看效果。😁😁😁😁😁是不是有那么一点游戏的感觉了？</p>

</div>
<div id="div_right_list">
<a name='a_a' href='#a_a'>摄像机</a>
<a name='a_b' href='#a_b'>并没有摄像机</a>
<a name='a_c' href='#a_c'>构建摄像机</a>
<a name='a_d' href='#a_d'>建立相机坐标系</a>
<a name='a_e' href='#a_e'>旋转</a>
<a name='a_f' href='#a_f'>平移</a>
<a name='a_g' href='#a_g'>添加限制</a>
<a name='a_h' href='#a_h'>使用相机</a>
</div>
</div>
</body>
</html>
